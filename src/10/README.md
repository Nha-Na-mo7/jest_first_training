# No.10 時間を扱うテストを書こう

## 目標
- 時間を設定したテストの基本的な書き方がわかる
- テストの共通セットアップの書き方がわかる

## 課題
1. 共通セットアップフックを使って、各テストの前に偽タイマーの起動と、テスト終了時の真タイマーへの復帰作業を行ってみよう。
2. `greet`関数の閾値となる時間に設定してそれぞれテストを書いてみよう。

## 概要
- テスト対象の関数が、時刻によって処理結果が変わる実装を持つ場合、そのままでは正しくテストを行えない。
  - 指定の時刻まで待つわけにもいかず、時間のせいでCIが落ちることもあってはならない。
- Jestに対して、「偽タイマー」を使用するよう指示することで、テスト実行環境における「現在時刻」を任意の時刻に設定してテストを行うことができる。

- 基本的には、テストを行う前に`useFakeTimers`を、テスト終了時に`useRealTimers`を実行させる使い方をする。
- 共通セットアップ作業には、`beforeEach`フックや`afterEach`フックを活用する。
- セットアップの順序は、フックによって異なるためドキュメントを確認しておくこと。
  - https://jestjs.io/ja/docs/setup-teardown

### 主に使う関数
- `jest.useFakeTimers`: この関数を実行後、Jestは偽タイマーを使用する。
- `jest.setSystemTime`: 偽タイマーのシステム時刻を設定する。
- `jest.useRealTimers`: Jestは偽タイマーの使用をやめ、本来のタイマーを使用するように指示する。